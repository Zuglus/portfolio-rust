#!/bin/bash

echo "üèóÔ∏è –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞..."

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m'

# –ö–æ–º–ø–∏–ª—è—Ü–∏—è —Å—Ç–∏–ª–µ–π
echo "üé® –ö–æ–º–ø–∏–ª—è—Ü–∏—è —Å—Ç–∏–ª–µ–π..."
npx tailwindcss -i ./style/main.scss -o ./style/output.css --minify

# –°–±–æ—Ä–∫–∞ —á–µ—Ä–µ–∑ Trunk
echo "üì¶ –°–±–æ—Ä–∫–∞ WASM –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è..."
trunk build --release

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
if [ -d "dist" ]; then
    echo -e "${GREEN}‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!${NC}"
    echo "üìÅ –§–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ dist/"
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤
    echo "üìä –†–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤:"
    find dist -type f -exec ls -lh {} \; | awk '{print $5, $9}'
else
    echo -e "${RED}‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏${NC}"
    exit 1
fi
