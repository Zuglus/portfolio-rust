#!/bin/bash

echo "üöÄ –ó–∞–ø—É—Å–∫ dev-—Å–µ—Ä–≤–µ—Ä–∞ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏..."

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
NC='\033[0m'

# –ó–∞–ø—É—Å–∫–∞–µ–º TailwindCSS –≤ —Ä–µ–∂–∏–º–µ watch –≤ —Ñ–æ–Ω–µ
echo -e "${BLUE}üé® –ó–∞–ø—É—Å–∫ TailwindCSS watcher —Å JIT...${NC}"
npx tailwindcss -i ./style/main.scss -o ./style/output.css --watch &
TAILWIND_PID=$!

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
cleanup() {
    echo -e "${YELLOW}üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤...${NC}"
    kill $TAILWIND_PID 2>/dev/null
    exit 0
}

# –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º —Å–∏–≥–Ω–∞–ª—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
trap cleanup INT TERM

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ dev-—Ä–µ–∂–∏–º–∞
export RUSTFLAGS="--cfg=erase_components"

echo -e "${GREEN}‚ö° –í–∫–ª—é—á–µ–Ω—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è dev-—Ä–µ–∂–∏–º–∞:${NC}"
echo "   ‚Ä¢ erase_components –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏"
echo "   ‚Ä¢ TailwindCSS JIT —Ä–µ–∂–∏–º"
echo "   ‚Ä¢ Hot reload –¥–ª—è —Å—Ç–∏–ª–µ–π"

# –ó–∞–ø—É—Å–∫–∞–µ–º Trunk dev-—Å–µ—Ä–≤–µ—Ä —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏
echo -e "${BLUE}ü¶Ä –ó–∞–ø—É—Å–∫ Trunk dev-—Å–µ—Ä–≤–µ—Ä–∞...${NC}"
trunk serve --open

# –û—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
cleanup
